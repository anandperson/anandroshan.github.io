(this["webpackJsonpreact-redux-realworld-example-app"]=this["webpackJsonpreact-redux-realworld-example-app"]||[]).push([[35],{1242:function(e,t,a){"use strict";a.r(t);var n=a(7),c=a.n(n),o=a(13),r=a(53),i=a(29),s=a(30),l=a(32),u=a(31),m=a(886),d=a(870),p=a.n(d),f=a(974),g=a.n(f),h=a(0),b=a.n(h),v=(a(975),a(871)),y=a(872),E=a.n(y),j=a(15),O=a(33),w=a(848),N=a(64),S=a(784),k=a(35),C=a(833);a(841);var x=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(i.a)(this,a),(n=t.call(this,e)).tagChange=function(e){console.log(e)},n.setStateFunc=function(e,t){n.setState(Object(r.a)({},e,t))},n.getData=function(){Object(S.l)({postid:n.props.match.params.id}).then((function(e){var t=e.post[0];console.log(t),n.setState({id:t._id,title:t.subject,draft:t,data:JSON.parse(t.editorContent),text:t.text,amount:t.price,tags:void 0==t.hashtags||void 0==t.hashtags[0]||""==t.hashtags[0]?[]:t.hashtags,currency:t.preferedCurrency,category:t.category,categoryId:t.categoryId,paymentType:t.paidPost?"paid":"free",edit_image:void 0==t.contents[0]?null:t.contents[0].content_url,category2:t.category+"^"+t.categoryId},(function(){setTimeout((function(){n.setState({loading:!1})}),1e3)}))}),(function(e){n.setState({loading:!1})}))},n.getDraft=function(){Object(S.f)().then((function(e){n.setState({id:e._id,title:e.subject,draft:e,data:JSON.parse(e.editorContent),text:e.text,amount:e.price,tags:void 0==e.hashtags||void 0==e.hashtags[0]||""==e.hashtags[0]?[]:e.hashtags,currency:e.preferedCurrency,category:e.category,categoryId:e.categoryId,paymentType:e.paidPost?"paid":"free",edit_image:void 0==e.contents[0]?null:e.contents[0].content_url,category2:e.category+"^"+e.categoryId},(function(){setTimeout((function(){n.setState({loading:!1})}),1e3)}))}),(function(e){n.setState({loading:!1})}))},n.onEditorStateChange=function(e){n.setState({editorState:e})},n.handleInput=function(e){var t=e.target.value,a=e.target.name;console.log(a+":"+t),n.setState(Object(r.a)({},a,t))},n.handleRemove=function(e){var t=e.target.getAttribute("name");n.setState(Object(r.a)({},t,null))},n.handleFile=function(e,t,a){console.log(a),n.setState(Object(r.a)({},e,a),(function(){var t=new FileReader;t.onload=function(t){document.getElementById(e+"_preview").src=t.target.result},t.readAsDataURL(a)}))},n.handleCheckbox=function(e){var t=e.target.name;if(console.log(t),e.target.checked){var a=e.target.value;console.log(a),n.setState(Object(r.a)({},t,a))}else{a=e.target.getAttribute("uncheckedValue");console.log(a),n.setState(Object(r.a)({},t,a))}},n.handleCategory=function(e){var t=e.target.value,a=t.split("^");console.log(a),n.setState({category2:t,category:a[0],categoryId:a[1]})},n.dataChange=function(e){console.log(e)},n.submit=function(){var e=Object(o.a)(c.a.mark((function e(t,a){var r,i,s,l,u,m,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,n.editor.save();case 3:r=e.sent,i=[],s="active",1==a?(""==n.state.title&&i.push("Title is required"),""==n.state.category&&i.push("Category is required"),r.blocks.length<=0&&i.push("Content is required"),null==n.state.post_image&&null==n.state.edit_image&&i.push("Main Image is required")):(""==n.state.title&&i.push("Title is required"),s="draft"),i.length>0?Object(j.a)(!0,i.join(", ")):(l=(l=n.state.edjsParser.parse(r)).join(" "),u=n.state.post_image,m=n.state.tags.length>0?n.state.tags.join(","):"",d=new FormData,0!=n.state.id&&d.append("id",n.state.id),d.append("postImgs",u),d.append("text",l),d.append("editorContent",JSON.stringify(r)),d.append("subject",n.state.title),d.append("hashtags",m),d.append("paymentType",n.state.paymentType),d.append("amount",n.state.amount),d.append("currency",n.state.currency),d.append("category",n.state.category),d.append("categoryId",n.state.categoryId),d.append("status",s),Object(j.b)("Your post is being updated..."),Object(S.c)(d).then(function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(j.b)(),1==a?window.location.href="/blogs":(Object(j.a)(!0,"Draft has been saved!","success"),n.props.history.push("/edit-blog/"+t.post.slug));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){Object(j.b)()})));case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.uploadImageCallBack=function(e){return new Promise((function(t,a){Object(k.K)({file:e}).then((function(e){var a={data:{link:e.file.filePath}};console.log(a),t(a)}),(function(e){a(e)}))}))},n.review=function(){};var s=p()(),l=g()('{"time":1612692654392,"blocks":[{"type":"paragraph","data":{"text":"sdff"}},{"type":"paragraph","data":{"text":"<b>sdfsdf</b>"}}],"version":"2.19.1"}');n.editor=b.a.createRef();var u=null;if(l){var d=m.ContentState.createFromBlockArray(l.contentBlocks);u=m.EditorState.createWithContent(d)}return n.state={id:0,data:"",loading:!0,categories:[],editorState:u,editorInstance:null,edjsParser:s,refreshing:!1,filter:"",title:"",post_image:null,edit_image:null,latestpost:{},paymentType:"free",currentTab:0,tags:[],currency:"",amount:0,category2:"",category:"",categoryId:"",suggestions:[{id:3,name:"Bananas"},{id:4,name:"Mangos"},{id:5,name:"Lemons"},{id:6,name:"Apricots"}]},n.reactTags=b.a.createRef(),n}return Object(s.a)(a,[{key:"onDelete",value:function(e){var t=this.state.tags.slice(0);t.splice(e,1),this.setState({tags:t})}},{key:"onAddition",value:function(e){var t=[].concat(this.state.tags,e);this.setState({tags:t})}},{key:"componentDidMount",value:function(){var e=this;console.log(this.props.currentUser),Object(S.e)().then((function(t){e.setState({categories:t})}),(function(e){}));try{void 0!=this.props.match.params.id?this.getData():this.setState({loading:!1})}catch(t){this.setState({loading:!1})}}},{key:"componentDidUpdate",value:function(e){if(e.match.params.id!=this.props.match.params.id)try{void 0!=this.props.match.params.id?this.getData():this.setState({loading:!1})}catch(t){this.setState({loading:!1})}}},{key:"render",value:function(){var e=this;return b.a.createElement("div",{className:"addBlogPage"},b.a.createElement("div",{className:"container my-wall-container "},b.a.createElement("div",{className:"row mt-2"},b.a.createElement("div",{className:"col-sm empty-container-with-border center-column big mx-auto p-4"},b.a.createElement("h1",{className:"text-center"},"Add an Article"),b.a.createElement("form",{onSubmit:function(t){return e.submit(t,1)},method:"post"},b.a.createElement("div",{className:"form-group"},b.a.createElement("strong",null,"Title of the Article"),b.a.createElement("input",{type:"text",placeholder:"Alpha numeric",name:"title",value:this.state.title,className:"form-control",onChange:this.handleInput})),b.a.createElement("div",{className:"form-group"},b.a.createElement("strong",null,"Content"),this.state.loading?b.a.createElement(N.a,null):b.a.createElement(v.a,{instanceRef:function(t){e.editor=t},data:this.state.data,tools:C.a})),b.a.createElement("div",{className:"form-group"},b.a.createElement("div",{className:"form-check"},b.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"paymentType",value:"paid",uncheckedValue:"free",checked:"paid"==this.state.paymentType,onChange:this.handleCheckbox}),b.a.createElement("label",{className:"form-check-label",for:"defaultCheck1"},"Make this article paid"))),"paid"==this.state.paymentType&&b.a.createElement("div",{className:"row"},b.a.createElement("div",{className:"col-md-6"},b.a.createElement("div",{className:"form-group"},b.a.createElement("strong",null,"Price"),b.a.createElement("input",{type:"text",placeholder:"Amount",name:"amount",className:"form-control",value:this.state.amount,onChange:this.handleInput}),b.a.createElement("small",{className:"text-secondary"},"Enter how much you want to charge for your content"))),b.a.createElement("div",{className:"col-md-6"},b.a.createElement("div",{className:"form-group"},b.a.createElement("strong",null,"Currency"),b.a.createElement("select",{type:"text",placeholder:"Amount",className:"form-control",name:"currency",value:this.state.currency,onChange:this.handleInput},b.a.createElement("option",{value:""},"Choose"),b.a.createElement("option",null,"BTC"),b.a.createElement("option",null,"ETH"),b.a.createElement("option",null,"LTC"),b.a.createElement("option",null,"XRP"),b.a.createElement("option",null,"BCH"),b.a.createElement("option",null,"USDT"),b.a.createElement("option",null,"DASH"),b.a.createElement("option",null,"USD"),b.a.createElement("option",null,"EUR"),b.a.createElement("option",null,"INR")),b.a.createElement("small",{className:"text-secondary"},"Enter how much you want to charge for your content")))),b.a.createElement("div",{className:"row"},b.a.createElement("div",{className:"col-md-6"},b.a.createElement("div",{className:"form-group"},b.a.createElement("strong",null,"Main Image"),b.a.createElement(w.a,{name:"post_image",page:"blogs",fileChange:this.handleFile,value:this.state.post_image,accept:"image/*"}),b.a.createElement("small",{className:"text-secondary"},"Select the main image for your article"),null==this.state.post_image&&null!=this.state.edit_image&&b.a.createElement("div",{className:"uploadedImage"},b.a.createElement("img",{src:this.state.edit_image,id:"post_image_preview"})),null!=this.state.post_image&&b.a.createElement("div",{className:"uploadedImage"},b.a.createElement("img",{src:this.state.post_image.tmp_name,id:"post_image_preview"}),b.a.createElement("div",{className:"fa fa-times remove",name:"post_image",onClick:this.handleRemove})))),b.a.createElement("div",{className:"col-md-6"},b.a.createElement("div",{className:"form-group"},b.a.createElement("strong",null,"Category"),b.a.createElement("select",{type:"text",name:"category",className:"form-control",value:this.state.category2,onChange:this.handleCategory},b.a.createElement("option",{value:""},"Select"),this.state.categories.map((function(t,a){return b.a.createElement("option",{value:t.category+"^"+t._id,key:a,selected:t.category==e.state.category},t.category)}))),b.a.createElement("small",{className:"text-secondary"},"Select one related")))),b.a.createElement("div",{className:"form-group"},b.a.createElement("strong",null,"Tags"),b.a.createElement(E.a,{onItemAdded:function(t,a){return e.setState({tags:a})},onItemDeleted:function(t,a){return e.setState({tags:a})},label:"",values:this.state.tags,name:"item-input",placeholder:"Do not include #"}),b.a.createElement("small",{className:"text-secondary"},"Separate tags using commas")),b.a.createElement("div",{className:"form-group text-center"},b.a.createElement(O.a,{type:"button",onClick:function(t){return e.submit(t,0)},variant:"primary-outline",size:"big mr-2"},"Save Draft"),b.a.createElement(O.a,{variant:"primary",size:"big"},"Publish")))))))}}]),a}(b.a.Component);t.default=x},784:function(e,t,a){"use strict";a.d(t,"e",(function(){return o})),a.d(t,"c",(function(){return r})),a.d(t,"t",(function(){return i})),a.d(t,"k",(function(){return s})),a.d(t,"i",(function(){return l})),a.d(t,"p",(function(){return u})),a.d(t,"l",(function(){return m})),a.d(t,"j",(function(){return d})),a.d(t,"h",(function(){return p})),a.d(t,"d",(function(){return f})),a.d(t,"b",(function(){return g})),a.d(t,"s",(function(){return h})),a.d(t,"q",(function(){return b})),a.d(t,"a",(function(){return v})),a.d(t,"n",(function(){return y})),a.d(t,"o",(function(){return E})),a.d(t,"m",(function(){return j})),a.d(t,"r",(function(){return O})),a.d(t,"f",(function(){return w})),a.d(t,"g",(function(){return N}));var n=a(2),c=a(4),o=function(e){return new Promise((function(t,a){Object(c.a)("".concat(n.a.baseUrl,"get-blog-categories"),!0,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))},r=function(e){return new Promise((function(t,a){Object(c.c)(n.a.baseUrl+"create-blog-post",!0,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))},i=function(e){return new Promise((function(t,a){Object(c.c)(n.a.baseUrl+"update-blog-post",!0,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))},s=function(e,t){return new Promise((function(a,o){Object(c.a)(n.a.baseUrl+"get-blog-posts",t,e).then((function(e){a(e.data)})).catch((function(e){o(e.response)}))}))},l=function(e){return new Promise((function(t,a){Object(c.a)(n.a.baseUrl+"get-filtered-blog-posts",!0,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))},u=function(e){return new Promise((function(t,a){Object(c.c)(n.a.baseUrl+"remove-blog-post",!0,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))},m=function(e){return new Promise((function(t,a){Object(c.a)(n.a.baseUrl+"get-blog",!1,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))},d=function(e){return new Promise((function(t,a){Object(c.a)(n.a.baseUrl+"get-popular-blogs",!0,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))},p=function(e){return new Promise((function(t,a){Object(c.a)(n.a.baseUrl+"get-category-blogs",!0,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))},f=function(e){return new Promise((function(t,a){Object(c.a)(n.a.baseUrl+"get-author-blogs",!0,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))},g=function(e){return new Promise((function(t,a){Object(c.c)(n.a.baseUrl+"blog-clap",!0,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))},h=function(e){return new Promise((function(t,a){Object(c.c)(n.a.baseUrl+"send-tips",!0,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))},b=function(e){return new Promise((function(t,a){Object(c.c)(n.a.baseUrl+"purchase-blog",!0,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))},v=function(e){return new Promise((function(t,a){Object(c.a)(n.a.baseUrl+"check-purchased-blog",!0,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))},y=function(e,t){return new Promise((function(a,o){Object(c.c)(n.a.baseUrl+"like-blog",t,e).then((function(e){a(e.data)})).catch((function(e){o(e.response)}))}))},E=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((function(a,o){Object(c.c)(n.a.baseUrl+"comment-blog",t,e).then((function(e){a(e.data)})).catch((function(e){o(e.response)}))}))},j=function(e,t){return new Promise((function(a,o){Object(c.c)(n.a.baseUrl+"like-comment-blog",t,e).then((function(e){a(e.data)})).catch((function(e){o(e.response)}))}))},O=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((function(a,o){Object(c.c)(n.a.baseUrl+"reply-comment-blog",t,e).then((function(e){a(e.data)})).catch((function(e){o(e.response)}))}))},w=function(e){return new Promise((function(t,a){Object(c.a)(n.a.baseUrl+"get-blog-draft",!0,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))},N=function(e){return new Promise((function(t,a){Object(c.a)(n.a.baseUrl+"blog-stats",!0,e).then((function(e){t(e.data)})).catch((function(e){a(e.response)}))}))}},833:function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n=a(908),c=a.n(n),o=a(909),r=a.n(o),i=a(910),s=a.n(i),l=a(911),u=a.n(l),m=a(912),d=a.n(m),p=(a(913),a(914)),f=a.n(p),g=a(915),h=a.n(g),b=a(916),v=a.n(b),y=a(917),E=a.n(y),j=a(918),O=a.n(j),w=a(919),N=a.n(w),S=a(920),k=a.n(S),C=a(921),x=a.n(C),P=a(922),U=a.n(P),I=a(2),_={embed:c.a,table:r.a,marker:O.a,list:s.a,warning:u.a,code:d.a,image:{class:f.a,config:{endpoints:{byFile:I.a.baseUrl+"editor-upload",byUrl:I.a.baseUrl+"fetchUrl"}}},raw:h.a,header:v.a,quote:E.a,checklist:N.a,delimiter:k.a,inlineCode:x.a,simpleImage:U.a}},841:function(e,t,a){},848:function(e,t,a){"use strict";var n=a(7),c=a.n(n),o=a(13),r=a(14),i=a(0),s=a.n(i),l=a(64),u=a(35),m=a(15);a(849);t.a=function(e){var t=Object(i.useState)(""),a=Object(r.a)(t,2),n=a[0],d=a[1],p=Object(i.useState)("valid"),f=Object(r.a)(p,2),g=f[0],h=f[1],b=Object(i.useState)(!1),v=Object(r.a)(b,2),y=v[0],E=v[1];Object(i.useEffect)((function(){var t=e.accept;if(void 0!=t&&null!=t&&""!=t&&"*"!=t){var a="valid ";t.split(",").forEach((function(e){"image/*"==e.trim()?a+="image":a+=", pdf"})),h(a)}}),[]);var j=function(e){var t=e.target.getAttribute("data-target");document.getElementById(t).click()};return s.a.createElement("div",{className:"fileBrowse"},s.a.createElement("div",{className:"d-flex justify-content-start align-items"},s.a.createElement("input",{className:"form-control",value:"upload"==e.type?n:void 0!=e.value?e.value.name:"",type:"text",placeholder:"jpg, png, jpeg, pdf files only","data-target":e.name,onClick:function(e){return j(e)}}),s.a.createElement("input",{type:"file",name:"file",className:"hide",id:e.name,onChange:function(t){return function(t){var a=t.target.files[0],n=e.accept,r=a.type;console.log(r);var i=r.split("/")[0];"application"==i&&(i=r,r.split("/")[1]),void 0==n||null==n||""==n||"*"==n||-1!=n.indexOf(i)?(d(a.name),"upload"==e.type?(E(!0),Object(u.K)({page:null==e.page?"general":e.page,file:a}).then(function(){var t=Object(o.a)(c.a.mark((function t(a){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.fileChange(e.name,e.type,a.file.filePath),console.log(a),E(!1);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(e){E(!1),Object(m.a)(!0,e.message)}))):e.fileChange(e.name,e.type,a)):Object(m.a)(!0,"Please choose "+g+" files only")}(t)},accept:void 0!=e.accept&&null!=e.accept?e.accept:"*"}),s.a.createElement("button",{className:"btn btn-main box","data-target":e.name,type:"button",onClick:function(e){return j(e)}},y?s.a.createElement(l.a,null):"Browse")))}},849:function(e,t,a){}}]);
//# sourceMappingURL=35.55a2920c.chunk.js.map
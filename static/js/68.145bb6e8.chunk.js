(this["webpackJsonpreact-redux-realworld-example-app"]=this["webpackJsonpreact-redux-realworld-example-app"]||[]).push([[68],{1257:function(e,t,a){"use strict";a.r(t);var r=a(29),n=a(30),c=a(32),s=a(31),i=a(984),l=a(0),o=a.n(l),u=a(829),m=a.n(u),d=a(15),y=a(11),p=a(33),h=a(231),f=a(232),b=a(64),g=a(479),E=a(233),v=a(2),C=a(24),N=a(67),S=a(197),j=a(65),O=(a(485),function(e){Object(c.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){try{var e=n.props.match.params.pair;if(void 0!=e&&null!=e&&""!=e){var t=e.split("_");n.setState({primaryCurrency:t[0],secondaryCurrency:t[1]})}}catch(a){}n.checkWallet()},n.componentDidUpdate=function(e){if(e.match.params.pair!=n.props.match.params.pair)try{var t=n.props.match.params.pair;if(void 0!=t&&null!=t&&""!=t){var a=t.split("_");n.setState({primaryCurrency:a[0],secondaryCurrency:a[1]},(function(){n.getCurrentPrice(),n.getBalance()}))}}catch(r){}},n.fav=function(e){Object(j.E)({fav:e}).then((function(e){Object(d.a)(!0,"Favourite list updated","success")}),(function(e){Object(d.a)(!0,"Something went wrong")}))},n.checkWallet=function(){Object(S.a)().then((function(e){console.log("walletcheck",e),n.setState({loading:!1,status:void 0==e.data.status?"":e.data.status},(function(){"Accept"==e.data.status&&(n.allCoins(),n.getReward(),n.getTickerPrice(),n.getCurrentPrice(),n.getBalance())}))}),(function(e){n.setState({loading:!1,error:"Authentication Error!"})}))},n.getFavs=function(){Object(j.v)().then((function(e){n.setState({favs:e.data})}),(function(e){}))},n.allPairs=function(){Object(j.n)().then((function(e){n.setState({pairs:e.message})}),(function(e){console.log(e)}))},n.allCoins=function(){var e=[];Object(j.s)().then((function(t){if(console.log("pair",t),null!=t){n.setState({pairs:t}),t.forEach((function(t){1==t.status&&null!=t.toCurrency&&1==t.toCurrency.curnType&&(console.log(t.pair),-1==(r=e.findIndex((function(e,a){return e.coin===t.toCurrency.currencySymbol})))?e.push({coin:t.toCurrency.currencySymbol,id:t.toCurrency._id,children:[{currencySymbol:t.fromCurrency.currencySymbol,currencyName:t.fromCurrency.currencyName,id:t.fromCurrency._id}]}):e[r].children.push({currencySymbol:t.fromCurrency.currencySymbol,currencyName:t.fromCurrency.currencyName,id:t.fromCurrency._id}))}));var a=n.state.secondaryCurrency,r=e.findIndex((function(e,t){return e.coin===a}));n.setState({trade_pairs:e,curKey:r})}}),(function(e){console.log(e)}))},n.changeTab=function(e){1==e||2==e?(n.setState({currentTab:e,loading:!0}),n.getTransactions()):n.setState({currentTab:e,loading:!1})},n.handlePrimary=function(e){n.setState({primaryCurrency:e,currentPrice:0,amount:"",price:"",primaryBalance:0,secondaryBalance:0},(function(){n.props.history.push("/wallet/trading/"+e+"_"+n.state.secondaryCurrency)}))},n.cancel=function(e,t){var a=0;n.state.pairs.forEach((function(e){e.pair==t&&(a=e._id)}));var r={order_id:e,pair_id:a};Object(j.a)(r).then((function(e){console.log(e),e.data.success?(Object(d.a)(!0,e.data.msg,"success"),n.getTransactions()):Object(d.a)(!0,e.data.msg),n.setState({loading:!1})}),(function(e){n.setState({loading:!1}),Object(d.a)(!0,"Unknown Error")}))},n.submit=function(e){console.log("test"),e.preventDefault();var t=0;n.state.pairs.forEach((function(e){e.pair==n.state.primaryCurrency+"_"+n.state.secondaryCurrency&&(t=e._id)}));var a={amount:Number(n.state.amount),ordertype:n.state.orderType,pair:t,price:Number(n.state.currentPrice),stop_price:Number(n.state.currentPrice),tocurrency_price:Number(n.state.currentPrice),tosymbol:n.state.secondaryCurrency,type:n.state.tradeType};""==n.state.amount||n.state.amount<=0?Object(d.a)(!0,"Please fill the valid amount!"):"buy"==n.state.tradeType&&n.state.price>n.state.secondaryBalance?Object(d.a)(!0,"Insufficient "+n.state.secondaryCurrency+" balance"):"sell"==n.state.tradeType&&n.state.amount>n.state.primaryBalance?Object(d.a)(!0,"Insufficient "+n.state.primaryCurrency+" balance"):(Object(d.b)(!0,"Submitting your order, please wait..."),Object(j.c)(a).then((function(e){console.log(e),e.data.success?(Object(d.a)(!0,e.data.msg,"success"),n.setState({price:"",amount:""}),n.getBalance()):Object(d.a)(!0,e.data.msg),Object(d.b)(),n.setState({reset:!0},(function(){setTimeout((function(){n.setState({reset:!1})}),1e3)}))}),(function(e){Object(d.b)(),Object(d.a)(!0,"Unknown Error")})))},n.handleSecondary=function(e){var t=n.state.trade_pairs.findIndex((function(t,a){return t.coin===e.target.value}));n.setState({secondaryCurrency:e.target.value,currentPrice:0,amount:"",price:"",primaryBalance:0,secondaryBalance:0,curKey:t},(function(){n.props.history.push("/wallet/trading/"+n.state.primaryCurrency+"_"+n.state.secondaryCurrency)}))},n.getBalance=function(){Object(j.k)().then((function(e){e.data.forEach((function(e){e.currencySymbol==n.state.primaryCurrency&&n.setState({primaryBalance:e.balance}),e.currencySymbol==n.state.secondaryCurrency&&n.setState({secondaryBalance:e.balance})}))}),(function(e){}))},n.handleAmountChange=function(e){var t=e.target.value;console.log(t);var a=(t*n.state.currentPrice).toFixed(8);n.setState({price:a,amount:t})},n.handlePriceChange=function(e){var t=e.target.value;console.log(t);var a=(t/n.state.currentPrice).toFixed(8);n.setState({amount:a,price:t})},n.activeTrades=function(){Object(j.i)({FilPerpage:5,FilPage:1}).then((function(e){n.setState({activeTrades:e.data})}))},n.getTransactions=function(){Object(j.r)({FilPerpage:10,FilPage:1,pair:n.state.primaryCurrency+"_"+n.state.secondaryCurrency}).then((function(e){n.setState({loading:!1,tradeHistory:e.data})}),(function(e){console.log(e)}))},n.getCurrentPrice=function(){Object(j.d)({pair:n.state.primaryCurrency+"_"+n.state.secondaryCurrency}).then((function(e){console.log(e),void 0!=e.data&&n.setState({currentPrice:e.data.marketPrice})}),(function(e){console.log(e)}))},n.changeFee=function(){var e={feesStatus:n.state.takeFee?0:1};Object(j.C)(e).then((function(e){}),(function(e){}))},n.getReward=function(){Object(j.u)().then((function(e){try{n.setState({takeFee:1==e.data.feesStatus})}catch(t){}})),Object(j.p)().then((function(e){try{n.setState({toggle:e.data[0].status})}catch(t){}}),(function(e){})),Object(N.g)((function(e){try{n.setState({toggle:e[0].status})}catch(t){}})),Object(N.f)((function(e){try{console.log(e)}catch(t){}}))},n.getTickerPrice=function(){Object(N.h)("liquiditypairdetails",(function(e){e.pair==n.state.primaryCurrency+"_"+n.state.secondaryCurrency&&n.setState({currentPrice:e.marketPrice})}))},n.state={toggle:0,takeFee:!1,attempt:0,favs:[],favPairs:!1,primaryCurrency:"BTC",secondaryCurrency:"USD",price:"",reset:!1,amount:"",primaryBalance:0,currentPrice:0,secondaryBalance:0,orderType:"instant",tradeType:"buy",activeTrades:[],cancelledTrades:[],curKey:0,tradeHistory:[],pairs:[],coins:[],trade_pairs:[],status:null,loading:!0,content:"loading",currentTab:0},n}return Object(n.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"container my-wall-container tradePage"},o.a.createElement("div",{className:"row mt-2"},o.a.createElement("div",{className:"col-sm empty-container-with-out-border left-column"},o.a.createElement(h.a,this.props)),this.state.loading&&o.a.createElement("div",{className:"col-sm empty-container-with-border center-column"},o.a.createElement(b.a,null)),"Accept"!=this.state.status&&!this.state.loading&&o.a.createElement("div",{className:"col-sm empty-container-with-border center-column"},o.a.createElement("p",{className:"text-danger text-center mt-4"},"Finish KYC to use this feature"),o.a.createElement("div",{className:"text-center"},o.a.createElement(y.a,{href:"/wallet/verification"},o.a.createElement("button",{className:"btn btn-main"},"Go to Verification")))),!this.state.loading&&"Accept"==this.state.status&&o.a.createElement("div",{className:"col-sm empty-container-with-border center-column"},o.a.createElement(f.a,this.props),o.a.createElement(g.a,{tabs:["Buy / Sell","Trade History"],type:"transactions",className:"noBorder",currentTab:this.state.currentTab,changeTab:this.changeTab}),0==this.state.currentTab?o.a.createElement("div",{className:"tab row m--1 mt-2"},o.a.createElement("div",{className:"col-md-5 p-1"},o.a.createElement("div",{className:"bordered p-3"},o.a.createElement("div",{className:"basePairs d-flex align-items-center justify-between"},o.a.createElement("select",{className:"form-control mb-2",onChange:this.handleSecondary},this.state.trade_pairs.length>0&&this.state.trade_pairs.map((function(t,a){return o.a.createElement("option",{value:t.coin,selected:e.state.secondaryCurrency==t.coin},t.coin)})))),o.a.createElement("div",{className:"bottom-border-list"},this.state.favPairs?null:void 0!=this.state.trade_pairs[this.state.curKey]&&this.state.trade_pairs[this.state.curKey].children.length>0&&this.state.trade_pairs[this.state.curKey].children.map((function(t,a){return o.a.createElement("div",{className:"list-item pointer "+(e.state.primaryCurrency==t.currencySymbol?"bg-main text-white":""),onClick:function(){return e.handlePrimary(t.currencySymbol)},key:a},t.currencyName," (",t.currencySymbol,") ",o.a.createElement("span",{className:"fa fa-chevron-right"}))}))))),o.a.createElement("div",{className:"col-md-7 p-1"},o.a.createElement("div",{className:"bordered p-3"},o.a.createElement("div",{className:"d-flex align-items-center justify-content-between"},o.a.createElement("p",null,o.a.createElement("strong",null,"Pair:")," ",this.state.primaryCurrency,"_",this.state.secondaryCurrency),o.a.createElement("p",{className:"text-small  text-right"},"1 ",o.a.createElement("span",{className:"text-primary"},this.state.primaryCurrency)," = ",this.state.currentPrice.toFixed(8)," ",o.a.createElement("span",{className:"text-primary"},this.state.secondaryCurrency))),o.a.createElement("div",{className:"form-group"},o.a.createElement("div",{className:"switch-buttons mb-4"},o.a.createElement("button",{onClick:function(){e.setState({tradeType:"buy"})},className:"btn box "+("buy"==this.state.tradeType?"btn-main":"btn-light")},"Buy"),o.a.createElement("button",{onClick:function(){e.setState({tradeType:"sell"})},className:"btn box "+("sell"==this.state.tradeType?"btn-main":"btn-light")},"Sell"))),o.a.createElement("div",{className:"form-group"},o.a.createElement("div",{className:"d-flex justify-content-start align-items"},o.a.createElement("input",{type:"text",value:this.state.primaryCurrency,className:"form-control currencySelect",disabled:!0}),o.a.createElement("input",{className:"form-control",type:"number",min:0,placeholder:"Amount",value:this.state.amount,onChange:this.handleAmountChange}))),o.a.createElement("div",{className:"d-flex align-items-center justify-content-between"},o.a.createElement("div",null,o.a.createElement("strong",null,this.state.primaryCurrency," Bal"),o.a.createElement("div",null,o.a.createElement("small",null,this.state.primaryBalance.toFixed(8)))),o.a.createElement("div",{className:"text-right"},o.a.createElement("strong",null,this.state.secondaryCurrency," Bal"),o.a.createElement("div",null,o.a.createElement("small",null,this.state.secondaryBalance.toFixed(8))))),o.a.createElement("div",{className:"form-group mt-80 d-flex align-items-center justify-content-between"},1==this.state.toggle?o.a.createElement("div",null,o.a.createElement(m.a,{value:this.state.takeFee||!1,onToggle:function(t){console.log(!t),e.setState({takeFee:!t},e.changeFee())}}),o.a.createElement("small",null,"Take fee from Reward Points  ")):o.a.createElement("div",null),o.a.createElement(p.a,{size:"big",className:"text-uppercase",disabled:this.state.loading,onClick:this.submit},this.state.loading?o.a.createElement(b.a,null):o.a.createElement("div",null,this.state.tradeType," ",this.state.primaryCurrency))),o.a.createElement("a",{href:v.a.tradeBase+"?pair="+this.state.primaryCurrency+"_"+this.state.secondaryCurrency+"&token="+localStorage.getItem("walletToken"),className:"advancedTrading",target:"_blank"},o.a.createElement("img",{src:Object(C.a)("candlestick2.png")}),o.a.createElement("div",null,o.a.createElement("h3",null,"Advanced Trading"),o.a.createElement("p",null,"Charts, Order Books, Market Depth, etc...")))))):o.a.createElement("div",{className:"tab mt-3 p-2"},this.state.loading?o.a.createElement(b.a,null):o.a.createElement("div",null,o.a.createElement("h3",null,"Trade History - ",this.state.primaryCurrency+"_"+this.state.secondaryCurrency),this.state.tradeHistory.length>0?o.a.createElement("table",{className:"table"},o.a.createElement("tr",{className:"whiteBg title"},o.a.createElement("td",null,"Placed at"),o.a.createElement("td",null,"Pair"),o.a.createElement("td",null,"Order ID"),o.a.createElement("td",null,"Order Type"),o.a.createElement("td",null,"Type"),o.a.createElement("td",null,"Price"),o.a.createElement("td",null,"Qty"),o.a.createElement("td",null,"Fee")),this.state.tradeHistory.map((function(e,t){return o.a.createElement("tr",null,o.a.createElement("td",{className:"time"},i(e.created_at).format("MMM DD, YY hh:mm A")),o.a.createElement("td",{className:"time"},e.pair),o.a.createElement("td",{className:"time"},"buy"==e.type.toLowerCase()?e.buyuorderId:e.selluorderId),o.a.createElement("td",{className:"time"},e.ordertype),o.a.createElement("td",{className:"time"},e.type),o.a.createElement("td",{className:"time"},e.askPrice.toFixed(8)),o.a.createElement("td",{className:"time"},e.askAmount),o.a.createElement("td",{className:"time"},e.fee.toFixed(8)))}))):o.a.createElement("p",{className:"bordered no-found"},"No Orders Found")))),o.a.createElement("div",{className:"col-sm empty-container-with-out-border right-column"},!this.state.reset&&o.a.createElement(E.a,null))))}}]),a}(o.a.Component));t.default=O},878:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}}}]);
//# sourceMappingURL=68.145bb6e8.chunk.js.map